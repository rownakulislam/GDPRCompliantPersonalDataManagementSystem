{"ast":null,"code":"var _jsxFileName = \"C:\\\\thesis_project_start\\\\Ethereum-DappV2\\\\src\\\\View.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { ethers } from 'ethers';\nimport { create } from 'ipfs-http-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst client = create({\n  host: '127.0.0.1',\n  port: 5001,\n  protocol: 'http'\n});\nfunction ViewComponent() {\n  _s();\n  const [userAddress, setUserAddress] = useState('');\n  const [fileUrl, setFileUrl] = useState(null);\n  //const [recipientAddress, setRecipientAddress] = useState('');\n\n  const CONTRACT_ADDRESS = process.env.REACT_APP_CONTRACT_ADDRESS;\n  const API_KEY = process.env.REACT_APP_API_KEY;\n  const PRIVATE_KEYA = process.env.REACT_APP_PRIVATE_KEY_A;\n  const PRIVATE_KEY1 = process.env.REACT_APP_PRIVATE_KEY_1;\n  const network = 'maticmum';\n  const provider = new ethers.providers.AlchemyProvider(network, API_KEY);\n  const signer = new ethers.Wallet(PRIVATE_KEY1, provider);\n  const contractABI = require('./abis/Temp.json');\n  const contract = new ethers.Contract(CONTRACT_ADDRESS, contractABI, signer);\n  async function fetchFileFromIPFS() {\n    try {\n      console.log(\"here\");\n      var d = new Date();\n      d = new Date(d.getTime() - 3000000);\n      var date_format_str = d.getFullYear().toString() + \"-\" + ((d.getMonth() + 1).toString().length == 2 ? (d.getMonth() + 1).toString() : \"0\" + (d.getMonth() + 1).toString()) + \"-\" + (d.getDate().toString().length == 2 ? d.getDate().toString() : \"0\" + d.getDate().toString()) + \" \" + (d.getHours().toString().length == 2 ? d.getHours().toString() : \"0\" + d.getHours().toString()) + \":\" + ((parseInt(d.getMinutes() / 5) * 5).toString().length == 2 ? (parseInt(d.getMinutes() / 5) * 5).toString() : \"0\" + (parseInt(d.getMinutes() / 5) * 5).toString()) + \":00\";\n      console.log(date_format_str);\n      const transactionObj1 = await contract.getUserData(userAddress, date_format_str);\n      const temp = await transactionObj1.wait();\n      const userData = temp.events[0].args._cid;\n      console.log(temp.events[0].args._cid);\n      const stream = client.cat(userData.toString());\n      let data = [];\n      for await (const chunk of stream) {\n        data.push(chunk);\n      }\n      const blob = new Blob(data, {\n        type: 'image/jpeg'\n      });\n      const url = URL.createObjectURL(blob);\n      setFileUrl(url);\n      const lastAccessor = await contract.getLastAccessor(userData.toString());\n      console.log(lastAccessor);\n    } catch (error) {\n      console.error('Error fetching file from IPFS:', error);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      placeholder: \"Your Address\",\n      onChange: e => setUserAddress(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: fetchFileFromIPFS,\n      children: \"Fetch File from IPFS\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), fileUrl && /*#__PURE__*/_jsxDEV(\"a\", {\n      href: fileUrl,\n      download: true,\n      children: \"Download File\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 19\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n}\n_s(ViewComponent, \"SJJNoQLzCzdFs5ZuHRm6OBf6/gQ=\");\n_c = ViewComponent;\nexport default ViewComponent;\nvar _c;\n$RefreshReg$(_c, \"ViewComponent\");","map":{"version":3,"names":["React","useState","ethers","create","jsxDEV","_jsxDEV","client","host","port","protocol","ViewComponent","_s","userAddress","setUserAddress","fileUrl","setFileUrl","CONTRACT_ADDRESS","process","env","REACT_APP_CONTRACT_ADDRESS","API_KEY","REACT_APP_API_KEY","PRIVATE_KEYA","REACT_APP_PRIVATE_KEY_A","PRIVATE_KEY1","REACT_APP_PRIVATE_KEY_1","network","provider","providers","AlchemyProvider","signer","Wallet","contractABI","require","contract","Contract","fetchFileFromIPFS","console","log","d","Date","getTime","date_format_str","getFullYear","toString","getMonth","length","getDate","getHours","parseInt","getMinutes","transactionObj1","getUserData","temp","wait","userData","events","args","_cid","stream","cat","data","chunk","push","blob","Blob","type","url","URL","createObjectURL","lastAccessor","getLastAccessor","error","children","placeholder","onChange","e","target","value","fileName","_jsxFileName","lineNumber","columnNumber","onClick","href","download","_c","$RefreshReg$"],"sources":["C:/thesis_project_start/Ethereum-DappV2/src/View.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { ethers } from 'ethers';\r\nimport { create } from 'ipfs-http-client';\r\n\r\nconst client = create({\r\n  host: '127.0.0.1',\r\n  port: 5001,\r\n  protocol: 'http',\r\n});\r\n\r\nfunction ViewComponent() {\r\n  const [userAddress, setUserAddress] = useState('');\r\n  const [fileUrl, setFileUrl] = useState(null);\r\n  //const [recipientAddress, setRecipientAddress] = useState('');\r\n\r\n  const CONTRACT_ADDRESS = process.env.REACT_APP_CONTRACT_ADDRESS;  \r\n  const API_KEY = process.env.REACT_APP_API_KEY;\r\n  const PRIVATE_KEYA=process.env.REACT_APP_PRIVATE_KEY_A;\r\n  const PRIVATE_KEY1=process.env.REACT_APP_PRIVATE_KEY_1;\r\n\r\n\r\n  const network = 'maticmum';\r\n  const provider = new ethers.providers.AlchemyProvider(network, API_KEY);\r\n  const signer = new ethers.Wallet(PRIVATE_KEY1, provider);\r\n\r\n  \r\n\r\n\r\n  const contractABI = require('./abis/Temp.json');\r\n  const contract = new ethers.Contract(CONTRACT_ADDRESS, contractABI, signer);\r\n\r\n  async function fetchFileFromIPFS() {\r\n    try {\r\n      console.log(\"here\");\r\n      var d = new Date();\r\n      d = new Date(d.getTime() - 3000000);\r\n      var date_format_str = d.getFullYear().toString()+\"-\"+((d.getMonth()+1).toString().length==2?(d.getMonth()+1).toString():\"0\"+(d.getMonth()+1).toString())+\"-\"+(d.getDate().toString().length==2?d.getDate().toString():\"0\"+d.getDate().toString())+\" \"+(d.getHours().toString().length==2?d.getHours().toString():\"0\"+d.getHours().toString())+\":\"+((parseInt(d.getMinutes()/5)*5).toString().length==2?(parseInt(d.getMinutes()/5)*5).toString():\"0\"+(parseInt(d.getMinutes()/5)*5).toString())+\":00\";\r\n      console.log(date_format_str);\r\n      const transactionObj1 = await contract.getUserData(userAddress,date_format_str);\r\n      const temp=await transactionObj1.wait();\r\n      const userData=temp.events[0].args._cid;\r\n      console.log(temp.events[0].args._cid);\r\n      \r\n      const stream = client.cat(userData.toString());\r\n      let data = [];\r\n\r\n      for await (const chunk of stream) {\r\n        data.push(chunk);\r\n      }\r\n\r\n      const blob = new Blob(data, { type: 'image/jpeg' });\r\n      const url = URL.createObjectURL(blob);\r\n      setFileUrl(url);\r\n      const lastAccessor = await contract.getLastAccessor(userData.toString());\r\n      console.log(lastAccessor);\r\n    } catch (error) {\r\n      console.error('Error fetching file from IPFS:', error);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Your Address\"\r\n        onChange={(e) => setUserAddress(e.target.value)}\r\n      />\r\n      \r\n      <button onClick={fetchFileFromIPFS}>Fetch File from IPFS</button>\r\n      {fileUrl && <a href={fileUrl} download>Download File</a>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ViewComponent;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,SAASC,MAAM,QAAQ,QAAQ;AAC/B,SAASC,MAAM,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1C,MAAMC,MAAM,GAAGH,MAAM,CAAC;EACpBI,IAAI,EAAE,WAAW;EACjBC,IAAI,EAAE,IAAI;EACVC,QAAQ,EAAE;AACZ,CAAC,CAAC;AAEF,SAASC,aAAaA,CAAA,EAAG;EAAAC,EAAA;EACvB,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EAC5C;;EAEA,MAAMe,gBAAgB,GAAGC,OAAO,CAACC,GAAG,CAACC,0BAA0B;EAC/D,MAAMC,OAAO,GAAGH,OAAO,CAACC,GAAG,CAACG,iBAAiB;EAC7C,MAAMC,YAAY,GAACL,OAAO,CAACC,GAAG,CAACK,uBAAuB;EACtD,MAAMC,YAAY,GAACP,OAAO,CAACC,GAAG,CAACO,uBAAuB;EAGtD,MAAMC,OAAO,GAAG,UAAU;EAC1B,MAAMC,QAAQ,GAAG,IAAIzB,MAAM,CAAC0B,SAAS,CAACC,eAAe,CAACH,OAAO,EAAEN,OAAO,CAAC;EACvE,MAAMU,MAAM,GAAG,IAAI5B,MAAM,CAAC6B,MAAM,CAACP,YAAY,EAAEG,QAAQ,CAAC;EAKxD,MAAMK,WAAW,GAAGC,OAAO,CAAC,kBAAkB,CAAC;EAC/C,MAAMC,QAAQ,GAAG,IAAIhC,MAAM,CAACiC,QAAQ,CAACnB,gBAAgB,EAAEgB,WAAW,EAAEF,MAAM,CAAC;EAE3E,eAAeM,iBAAiBA,CAAA,EAAG;IACjC,IAAI;MACFC,OAAO,CAACC,GAAG,CAAC,MAAM,CAAC;MACnB,IAAIC,CAAC,GAAG,IAAIC,IAAI,CAAC,CAAC;MAClBD,CAAC,GAAG,IAAIC,IAAI,CAACD,CAAC,CAACE,OAAO,CAAC,CAAC,GAAG,OAAO,CAAC;MACnC,IAAIC,eAAe,GAAGH,CAAC,CAACI,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,GAAC,GAAG,IAAE,CAACL,CAAC,CAACM,QAAQ,CAAC,CAAC,GAAC,CAAC,EAAED,QAAQ,CAAC,CAAC,CAACE,MAAM,IAAE,CAAC,GAAC,CAACP,CAAC,CAACM,QAAQ,CAAC,CAAC,GAAC,CAAC,EAAED,QAAQ,CAAC,CAAC,GAAC,GAAG,GAAC,CAACL,CAAC,CAACM,QAAQ,CAAC,CAAC,GAAC,CAAC,EAAED,QAAQ,CAAC,CAAC,CAAC,GAAC,GAAG,IAAEL,CAAC,CAACQ,OAAO,CAAC,CAAC,CAACH,QAAQ,CAAC,CAAC,CAACE,MAAM,IAAE,CAAC,GAACP,CAAC,CAACQ,OAAO,CAAC,CAAC,CAACH,QAAQ,CAAC,CAAC,GAAC,GAAG,GAACL,CAAC,CAACQ,OAAO,CAAC,CAAC,CAACH,QAAQ,CAAC,CAAC,CAAC,GAAC,GAAG,IAAEL,CAAC,CAACS,QAAQ,CAAC,CAAC,CAACJ,QAAQ,CAAC,CAAC,CAACE,MAAM,IAAE,CAAC,GAACP,CAAC,CAACS,QAAQ,CAAC,CAAC,CAACJ,QAAQ,CAAC,CAAC,GAAC,GAAG,GAACL,CAAC,CAACS,QAAQ,CAAC,CAAC,CAACJ,QAAQ,CAAC,CAAC,CAAC,GAAC,GAAG,IAAE,CAACK,QAAQ,CAACV,CAAC,CAACW,UAAU,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,EAAEN,QAAQ,CAAC,CAAC,CAACE,MAAM,IAAE,CAAC,GAAC,CAACG,QAAQ,CAACV,CAAC,CAACW,UAAU,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,EAAEN,QAAQ,CAAC,CAAC,GAAC,GAAG,GAAC,CAACK,QAAQ,CAACV,CAAC,CAACW,UAAU,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,EAAEN,QAAQ,CAAC,CAAC,CAAC,GAAC,KAAK;MACreP,OAAO,CAACC,GAAG,CAACI,eAAe,CAAC;MAC5B,MAAMS,eAAe,GAAG,MAAMjB,QAAQ,CAACkB,WAAW,CAACxC,WAAW,EAAC8B,eAAe,CAAC;MAC/E,MAAMW,IAAI,GAAC,MAAMF,eAAe,CAACG,IAAI,CAAC,CAAC;MACvC,MAAMC,QAAQ,GAACF,IAAI,CAACG,MAAM,CAAC,CAAC,CAAC,CAACC,IAAI,CAACC,IAAI;MACvCrB,OAAO,CAACC,GAAG,CAACe,IAAI,CAACG,MAAM,CAAC,CAAC,CAAC,CAACC,IAAI,CAACC,IAAI,CAAC;MAErC,MAAMC,MAAM,GAAGrD,MAAM,CAACsD,GAAG,CAACL,QAAQ,CAACX,QAAQ,CAAC,CAAC,CAAC;MAC9C,IAAIiB,IAAI,GAAG,EAAE;MAEb,WAAW,MAAMC,KAAK,IAAIH,MAAM,EAAE;QAChCE,IAAI,CAACE,IAAI,CAACD,KAAK,CAAC;MAClB;MAEA,MAAME,IAAI,GAAG,IAAIC,IAAI,CAACJ,IAAI,EAAE;QAAEK,IAAI,EAAE;MAAa,CAAC,CAAC;MACnD,MAAMC,GAAG,GAAGC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC;MACrCjD,UAAU,CAACoD,GAAG,CAAC;MACf,MAAMG,YAAY,GAAG,MAAMpC,QAAQ,CAACqC,eAAe,CAAChB,QAAQ,CAACX,QAAQ,CAAC,CAAC,CAAC;MACxEP,OAAO,CAACC,GAAG,CAACgC,YAAY,CAAC;IAC3B,CAAC,CAAC,OAAOE,KAAK,EAAE;MACdnC,OAAO,CAACmC,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACxD;EACF;EAEA,oBACEnE,OAAA;IAAAoE,QAAA,gBACEpE,OAAA;MACE6D,IAAI,EAAC,MAAM;MACXQ,WAAW,EAAC,cAAc;MAC1BC,QAAQ,EAAGC,CAAC,IAAK/D,cAAc,CAAC+D,CAAC,CAACC,MAAM,CAACC,KAAK;IAAE;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACjD,CAAC,eAEF7E,OAAA;MAAQ8E,OAAO,EAAE/C,iBAAkB;MAAAqC,QAAA,EAAC;IAAoB;MAAAM,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,EAChEpE,OAAO,iBAAIT,OAAA;MAAG+E,IAAI,EAAEtE,OAAQ;MAACuE,QAAQ;MAAAZ,QAAA,EAAC;IAAa;MAAAM,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACrD,CAAC;AAEV;AAACvE,EAAA,CA9DQD,aAAa;AAAA4E,EAAA,GAAb5E,aAAa;AAgEtB,eAAeA,aAAa;AAAC,IAAA4E,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}